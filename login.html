<!DOCTYPE html>
<html>
<head>
    <title>Login</title>
    <link rel="stylesheet" href="../style.css">
    <script src="https://unpkg.com/vue@3"></script>
    <script src="../store.js"></script>
</head>

<body>

<div id="loginApp" class="login-box">

    <h2>{{ role.toUpperCase() }} Login</h2>

    <input v-model="username" placeholder="Enter Username">
    <input v-model="password" type="password" placeholder="Enter Password">

    <button @click="loginUser">Login</button>
    <p>{{ message }}</p>

    <p><a href="../index.html">‚Üê Back</a></p>

</div>

<script>
const { createApp } = Vue;

createApp({
    data(){
        return{
            role: new URLSearchParams(location.search).get("role"),
            username: "",
            password: "",
            message: ""
        }
    },

    methods:{
        loginUser() {
            const users = Store.state.users;

            if (this.username === users[this.role].username &&
                this.password === users[this.role].password) {

                Store.state.currentUser = { role: this.role, username: this.username };
                Store.save();

                if (this.role === "teacher") {
                    window.location.href = "./teacher-dashboard.html";
                } else {
                    window.location.href = "./student-dashboard.html";
                }
            } else {
                this.message = "Invalid username or password!";
            }
        }
    }
}).mount("#loginApp");
</script>

</body>
</html>
